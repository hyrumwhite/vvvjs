var y=(e,r=[])=>{for(let t of r)typeof t=="string"&&(t=document.createTextNode(t)),e.appendChild(t)},E=(e,r)=>{let t=null;e instanceof Element?t=e:e=="fragment"?t=document.createDocumentFragment():t=document.createElement(e),t.v_listeners=[];let o=null;typeof r=="string"&&(r={textContent:r}),r instanceof Array&&(r={children:r});for(let n in r){let i=r[n];if(n==="parentElement")typeof i=="string"&&(i=document.querySelector(i)),o=i;else if(n==="shadowHost")typeof i=="string"&&(i=document.querySelector(i)),o=i.attachShadow({mode:"open",delegatesFocus:i.getAttribute("delegates-focus")==="true"});else if(n==="defineProperties")Object.defineProperties(t,i);else if(n==="style"&&typeof i=="object")Object.assign(t.style,i);else if(n==="children")y(t,i);else if(n==="shadowChildren"){let l=t.attachShadow({mode:"open",delegatesFocus:r.delegatesFocus===!0});y(l,i)}else typeof i=="function"?(t.addEventListener(n,i),t.v_listeners.push({prop:n,listener:i})):n in t?t[n]=i:t.setAttribute(n,i)}return t.v_destroy=()=>{if(t.v_listeners)for(let{prop:n,listener:i}of t.v_listeners){t.removeEventListener(n,i);for(let l of t.children)l.v_destroy&&l.v_destroy()}t.remove()},o&&o.appendChild(t),t},u=new Proxy(E,{get(e,r){return r==="textNode"?t=>document.createTextNode(t):E.bind(null,r)},apply(e,r,t){return e.apply(r,t)}});var h=function(e,{emitInputOnValueChange:r=!0}={}){typeof e=="string"&&(e=document.querySelector(e));function t(o){if(o.startsWith("$$")){let n=e.querySelectorAll(o.substring(2)),i=[];for(let l of n)i.push(h(l));return i}else if(o.startsWith("$")){let n=e.querySelector(o.substring(1));return h(n)||null}}return new Proxy(t,{get(o,n,i){let l=e[n];if(n==="$el")return e;if(typeof l=="function")return l.bind(e);if(n in e)return e[n];if(n.startsWith("$"))return o(n)},set(o,n,i){return e[n]=i,n==="value"&&r&&e.dispatchEvent(new CustomEvent("input",{detail:i})),!0},apply(o,n,i){return o.apply(n,i)}})};var P={keyId:0,createEventKey(e){return`${e}-${this.keyId++}`},handlers:{},addEventListener(e,r,t={}){this.handlers[e]||(this.handlers[e]=[]);let o=r;return t.removeWhen&&(o=n=>(t.removeWhen(n)&&this.removeEventListener(e,o),r(n))),this.handlers[e].push(o),this.removeEventListener.bind(this,e,o)},removeEventListener(e,r){this.handlers[e]&&(this.handlers[e]=this.handlers[e].filter(t=>t!==r))},dispatchEvent(e,r){this.handlers[e]&&this.handlers[e].forEach(t=>t(r))}};var b=(e,r="")=>{e.endsWith("/")&&(e=e.slice(0,-1)),r.endsWith("/")&&(r=r.slice(0,-1));let t=r.split("/"),o=e.split("/"),n={};if(t.length!=o.length)return{match:!1};for(let i=0;i<t.length;i++){let l=t[i],s=o[i];if(l.startsWith(":"))n[s.slice(1)]=s;else if(l!=s)return{match:!1}}return{match:!0,params:n}},c=async()=>{let e=window.location.pathname,r=Object.fromEntries(new URLSearchParams(window.location.search)),t=null,o=null;for(let n of a){n.default&&(t=n);let{match:i,params:l}=b(e,n.path);if(o={...r,...l},i){t=n;break}}if(t){let n={route:t,path:e,params:o,query:r};m&&await m(n),t.before&&await t.before(n);let{component:i,outlet:l}=t;l=l||d,typeof l=="string"&&(l=document.querySelector(l));let s=i(o);s instanceof Promise&&(s=await s),d.innerHTML="",s instanceof Element&&d.appendChild(s),t.after&&await t.after(n),p&&await p(n)}else console.warn('no matching route for "'+e+'"')},a=[],d=null,m=null,p=null,R=({routes:e,outlet:r,guards:t={}})=>(typeof r=="string"&&(r=document.querySelector(r)),d=r,a=e,m=t.beforeEach,p=t.afterEach,window.removeEventListener("popstate",c),window.addEventListener("popstate",c),c()),L=e=>{a=[...a,...e]},g=(e,r)=>(r&&(e=e.replace(/:([^/]+)/g,(t,o)=>r[o])),e),f=e=>{typeof e=="string"&&(e={path:e});let{path:r,name:t,params:o,query:n,delta:i,replace:l}=e;if(i)return window.history.go(i);if(t){let w=a.find(x=>x.name===t);if(!w)throw new Error(`No route found with name ${t}`);r=g(w.path,o)}let s=r;return n&&(s+=new URLSearchParams(n).toString()),l?window.history.replaceState(null,"",s):window.history.pushState(null,"",s),c()},S=(e=-1)=>f({delta:e}),q=(e=1)=>f({delta:e}),_=(...e)=>f({replace:!0,...e}),v=()=>a;var W=e=>{if(e.name){let r=v();e.to=r.find(t=>t.name===e.name).path}return u("a",{...e,href:g(e.to,e.params),click(r){r.preventDefault(),e.click?.(r),f(e.to,e.params)}})};var T=u;export{W as RouterLink,L as addRoutes,S as back,T as createElement,P as eventBus,q as forward,h as getElement,v as getRoutes,f as go,R as initializeRouter,_ as replace};
