function u(t,{emitInputOnValueChange:n=!0}={}){typeof t=="string"&&(t=document.querySelector(t));function e(l){if(l.startsWith("$$")){let r=t.querySelectorAll(l.substring(2)),i=[];for(let o of r)i.push(u(o));return i}else if(l.startsWith("$")){let r=t.querySelector(l.substring(1));return u(r)||null}}return new Proxy(e,{get(l,r,i){let o=t[r];if(r==="$el")return t;if(typeof o=="function")return o.bind(t);if(r in t)return t[r];if(r.startsWith("$"))return l(r)},set(l,r,i){return t[r]=i,r==="value"&&n&&t.dispatchEvent(new CustomEvent("input",{detail:i})),!0},apply(l,r,i){return l.apply(r,i)}})}var P=(t,n=[])=>{for(let e of n)typeof e=="string"&&(e=document.createTextNode(e)),t.appendChild(e)},g=(t,n)=>{let e=null;t instanceof Element?e=t:t=="fragment"?e=document.createDocumentFragment():e=document.createElement(t),e.v_listeners=[];let l=null;typeof n=="string"&&(n={textContent:n}),n instanceof Array&&(n={children:n});for(let r in n){let i=n[r];if(r==="parentElement")typeof i=="string"&&(i=document.querySelector(i)),l=i;else if(r==="shadowHost")typeof i=="string"&&(i=document.querySelector(i)),l=i.attachShadow({mode:"open",delegatesFocus:i.getAttribute("delegates-focus")==="true"});else if(r==="defineProperties")Object.defineProperties(e,i);else if(r==="style"&&typeof i=="object")Object.assign(e.style,i);else if(r==="children")P(e,i);else if(r==="shadowChildren"){let o=e.attachShadow({mode:"open",delegatesFocus:n.delegatesFocus===!0});P(o,i)}else typeof i=="function"?(e.addEventListener(r,i),e.v_listeners.push({prop:r,listener:i})):r in e?e[r]=i:e.setAttribute(r,i)}return e.v_destroy=()=>{if(e.v_listeners)for(let{prop:r,listener:i}of e.v_listeners){e.removeEventListener(r,i);for(let o of e.children)o.v_destroy&&o.v_destroy()}e.remove()},l&&l.appendChild(e),e},N=new Proxy(g,{get(t,n){return n==="textNode"?e=>document.createTextNode(e):g.bind(null,n)},apply(t,n,e){return t.apply(n,e)}});var L={keyId:0,createEventKey(t){return`${t}-${this.keyId++}`},handlers:{},addEventListener(t,n,e={}){this.handlers[t]||(this.handlers[t]=[]);let l=n;return e.removeWhen&&(l=r=>(e.removeWhen(r)&&this.removeEventListener(t,l),n(r))),this.handlers[t].push(l),this.removeEventListener.bind(this,t,l)},removeEventListener(t,n){this.handlers[t]&&(this.handlers[t]=this.handlers[t].filter(e=>e!==n))},dispatchEvent(t,n){this.handlers[t]&&this.handlers[t].forEach(e=>e(n))}};var q=["STYLE","SCRIPT","LINK"];var R=async(t,n={},{headNodeFilter:e,replaceTitle:l=!0,bodyElementSelector:r=null}={})=>{let[i,o]=t.split("#");o&&r===null&&(r=`#${o}`),e=e||q;let s=await fetch(i,n);if(s.ok){let f=await s.text();f=new DOMParser().parseFromString(f,"text/html");let S=f.querySelector("head")||document.createDocumentFragment(),E=f.querySelector("body")||document.createDocumentFragment();r&&(E=E.querySelector(r));for(let a of S.children)if(a.nodeName==="TITLE"&&l)document.title=a.textContent;else if(e==null||e.includes(a.nodeName)){let p=a.getAttribute("src"),I=a.getAttribute("src");if(document.head.querySelector(`[src="${p}"]`)==null){let x=document.createElement("script");for(let b of a.attributes)x.setAttribute(b.name,b.value);document.head.appendChild(x)}}else{let p=a.getAttribute("href");document.head.querySelector(`[href="${p}"]`)==null&&document.head.appendChild(a)}}return body};var C=(t,n="")=>{t.endsWith("/")&&(t=t.slice(0,-1)),n.endsWith("/")&&(n=n.slice(0,-1));let e=n.split("/"),l=t.split("/"),r={};if(e.length!=l.length)return{match:!1};for(let i=0;i<e.length;i++){let o=e[i],s=l[i];if(o.startsWith(":"))r[s.slice(1)]=s;else if(o!=s)return{match:!1}}return{match:!0,params:r}},c=async()=>{let t=window.location.pathname,n=Object.fromEntries(new URLSearchParams(window.location.search)),e=null,l=null;for(let r of h){r.default&&(e=r);let{match:i,params:o}=C(t,r.path);if(l={...n,...o},i){e=r;break}}if(e){let r={route:e,path:t,params:l,query:n};y&&await y(r),e.before&&await e.before(r);let{component:i,outlet:o}=e;o=o||d,typeof o=="string"&&(o=document.querySelector(o));let s=i(l);s instanceof Promise&&(s=await s),d.innerHTML="",s instanceof Element&&d.appendChild(s),e.after&&await e.after(r),w&&await w(r)}else console.warn('no matching route for "'+t+'"')},h=[],d=null,y=null,w=null,$=({routes:t,outlet:n,guards:e={}})=>(typeof n=="string"&&(n=document.querySelector(n)),d=n,h=t,y=e.beforeEach,w=e.afterEach,window.removeEventListener("popstate",c),window.addEventListener("popstate",c),c()),_=(t,n)=>(n&&(t=t.replace(/:([^/]+)/g,(e,l)=>n[l])),t),m=t=>{typeof t=="string"&&(t={path:t});let{path:n,name:e,params:l,query:r,delta:i,replace:o}=t;if(i)return window.history.go(i);if(e){let f=h.find(v=>v.name===e);if(!f)throw new Error(`No route found with name ${e}`);n=_(f.path,l)}let s=n;return r&&(s+=new URLSearchParams(r).toString()),o?window.history.replaceState(null,"",s):window.history.pushState(null,"",s),c()},A=(t=-1)=>m({delta:t}),T=(t=1)=>m({delta:t}),W=(...t)=>m({replace:!0,...t}),F=()=>h;var z=u;export{A as back,g as createElement,L as eventBus,R as fetchHtml,T as forward,z as getElement,F as getRoutes,m as go,$ as initializeRouter,W as replace};
