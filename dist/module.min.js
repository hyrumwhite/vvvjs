var q=Object.defineProperty,_=Object.defineProperties;var W=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var C=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var P=(e,r,t)=>r in e?q(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,u=(e,r)=>{for(var t in r||(r={}))C.call(r,t)&&P(e,t,r[t]);if(x)for(var t of x(r))$.call(r,t)&&P(e,t,r[t]);return e},b=(e,r)=>_(e,W(r));var R=(e,r,t)=>new Promise((o,n)=>{var i=s=>{try{a(t.next(s))}catch(f){n(f)}},l=s=>{try{a(t.throw(s))}catch(f){n(f)}},a=s=>s.done?o(s.value):Promise.resolve(s.value).then(i,l);a((t=t.apply(e,r)).next())});var L=(e,r=[])=>{for(let t of r)typeof t=="string"&&(t=document.createTextNode(t)),e.appendChild(t)},S=(e,r)=>{let t=null;e instanceof Element?t=e:e=="fragment"?t=document.createDocumentFragment():t=document.createElement(e),t.v_listeners=[];let o=null;typeof r=="string"&&(r={textContent:r}),r instanceof Array&&(r={children:r});for(let n in r){let i=r[n];if(n==="parentElement")typeof i=="string"&&(i=document.querySelector(i)),o=i;else if(n==="defineProperties")Object.defineProperties(t,i);else if(n==="style"&&typeof i=="object")Object.assign(t.style,i);else if(n==="children")L(t,i);else if(n==="shadowChildren"){let l=t.attachShadow({mode:"open",delegatesFocus:r.delegatesFocus===!0});L(l,i)}else if(typeof i=="function"){let[l,...a]=n.split("."),s={};for(let f of a)s[f]=!0;t.addEventListener(l,i,s,a.includes("capture")),t.v_listeners.push({prop:n,listener:i})}else n in t?t[n]=i:t.setAttribute(n,i)}return t.v_destroy=()=>{if(t.v_listeners)for(let{prop:n,listener:i}of t.v_listeners){t.removeEventListener(n,i);for(let l of t.children)l.v_destroy&&l.v_destroy()}t.remove()},o&&o.appendChild(t),t},h=new Proxy(S,{get(e,r){return r==="textNode"?t=>document.createTextNode(t):S.bind(null,r)},apply(e,r,t){return e.apply(r,t)}});var v=function(e,{emitInputOnValueChange:r=!0}={}){typeof e=="string"&&(e=document.querySelector(e));function t(o){if(o.startsWith("$$")){let n=e.querySelectorAll(o.substring(2)),i=[];for(let l of n)i.push(v(l));return i}else if(o.startsWith("$")){let n=e.querySelector(o.substring(1));return v(n)||null}}return new Proxy(t,{get(o,n,i){let l=e[n];if(n==="$el")return e;if(typeof l=="function")return l.bind(e);if(n in e)return e[n];if(n.startsWith("$"))return o(n)},set(o,n,i){return e[n]=i,n==="value"&&r&&e.dispatchEvent(new CustomEvent("input",{detail:i})),!0},apply(o,n,i){return o.apply(n,i)}})};var I={keyId:0,createEventKey(e){return`${e}-${this.keyId++}`},handlers:{},addEventListener(e,r,t={}){this.handlers[e]||(this.handlers[e]=[]);let o=r;return t.removeWhen&&(o=n=>(t.removeWhen(n)&&this.removeEventListener(e,o),r(n))),this.handlers[e].push(o),this.removeEventListener.bind(this,e,o)},removeEventListener(e,r){this.handlers[e]&&(this.handlers[e]=this.handlers[e].filter(t=>t!==r))},dispatchEvent(e,r){this.handlers[e]&&this.handlers[e].forEach(t=>t(r))}};var N=(e,r="")=>{e.endsWith("/")&&(e=e.slice(0,-1)),r.endsWith("/")&&(r=r.slice(0,-1));let t=r.split("/"),o=e.split("/"),n={};if(t.length!=o.length)return{match:!1};for(let i=0;i<t.length;i++){let l=t[i],a=o[i];if(l.startsWith(":"))n[a.slice(1)]=a;else if(l!=a)return{match:!1}}return{match:!0,params:n}},m=()=>R(void 0,null,function*(){let e=window.location.pathname,r=Object.fromEntries(new URLSearchParams(window.location.search)),t=null,o=null;for(let n of c){n.default&&(t=n);let{match:i,params:l}=N(e,n.path);if(o=u(u({},r),l),i){t=n;break}}if(t){let n={route:t,path:e,params:o,query:r};g&&(yield g(n)),t.before&&(yield t.before(n));let{component:i,outlet:l}=t;l=l||p,typeof l=="string"&&(l=document.querySelector(l));let a=i(o);a instanceof Promise&&(a=yield a),p.innerHTML="",a instanceof Element&&p.appendChild(a),t.after&&(yield t.after(n)),w&&(yield w(n))}else console.warn('no matching route for "'+e+'"')}),c=[],p=null,g=null,w=null,O=({routes:e,outlet:r,guards:t={}})=>(typeof r=="string"&&(r=document.querySelector(r)),p=r,c=e,g=t.beforeEach,w=t.afterEach,window.removeEventListener("popstate",m),window.addEventListener("popstate",m),m()),j=e=>{c=[...c,...e]},y=(e,r)=>(r&&(e=e.replace(/:([^/]+)/g,(t,o)=>r[o])),e),d=e=>{typeof e=="string"&&(e={path:e});let{path:r,name:t,params:o,query:n,delta:i,replace:l}=e;if(i)return window.history.go(i);if(t){let s=c.find(f=>f.name===t);if(!s)throw new Error(`No route found with name ${t}`);r=y(s.path,o)}let a=r;return n&&(a+=new URLSearchParams(n).toString()),l?window.history.replaceState(null,"",a):window.history.pushState(null,"",a),m()},F=(e=-1)=>d({delta:e}),T=(e=1)=>d({delta:e}),A=(...e)=>d(u({replace:!0},e)),E=()=>c;var U=e=>{if(e.name){let r=E();e.to=r.find(t=>t.name===e.name).path}return h("a",b(u({},e),{href:y(e.to,e.params),click(r){var t;r.preventDefault(),(t=e.click)==null||t.call(e,r),d(e.to,e.params)}}))};var Q=h,V=h;export{U as RouterLink,j as addRoutes,F as back,V as createElement,Q as default,I as eventBus,T as forward,v as getElement,E as getRoutes,d as go,O as initializeRouter,A as replace};
